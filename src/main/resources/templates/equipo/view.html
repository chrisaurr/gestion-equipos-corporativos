<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{shared/layout}">

<head>
    <title>Ver Equipo</title>
</head>

<body>
    <div layout:fragment="content">
        <!-- Content Header (Page header) -->
        <div class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-6">
                        <h1 class="m-0">Detalles del Equipo</h1>
                    </div>
                    <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-right">
                            <li class="breadcrumb-item"><a href="/dashboard">Dashboard</a></li>
                            <li class="breadcrumb-item"><a href="/equipos">Equipos</a></li>
                            <li class="breadcrumb-item active">Ver</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main content -->
        <section class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card card-primary card-outline">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-cogs"></i> 
                                    <span th:text="${equipo.identificador + ' - ' + equipo.nombre}"></span>
                                </h3>
                                <div class="card-tools">
                                    <span class="badge" 
                                          th:class="${equipo.estado?.name() == 'ACTIVO'} ? 'badge-success' : 
                                                    (${equipo.estado?.name() == 'INACTIVO'} ? 'badge-danger' : 
                                                    (${equipo.estado?.name() == 'MANTENIMIENTO'} ? 'badge-warning' : 'badge-dark'))"
                                          th:text="${equipo.estado}"></span>
                                </div>
                            </div>
                            
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Identificador:</th>
                                                <td th:text="${equipo.identificador}"></td>
                                            </tr>
                                            <tr>
                                                <th>Nombre:</th>
                                                <td th:text="${equipo.nombre}"></td>
                                            </tr>
                                            <tr>
                                                <th>Tipo:</th>
                                                <td>
                                                    <span th:switch="${equipo.tipoEquipo?.name()}">
                                                        <span th:case="'VEHICULO'" class="badge badge-primary">Vehículo</span>
                                                        <span th:case="'ELECTRONICO'" class="badge badge-info">Electrónico</span>
                                                        <span th:case="'MOBILIARIO'" class="badge badge-success">Mobiliario</span>
                                                        <span th:case="'HERRAMIENTA'" class="badge badge-warning">Herramienta</span>
                                                        <span th:case="*" th:text="${equipo.tipoEquipo}"></span>
                                                    </span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>Estado:</th>
                                                <td>
                                                    <span class="badge" 
                                                          th:class="${equipo.estado?.name() == 'ACTIVO'} ? 'badge-success' : 
                                                                    (${equipo.estado?.name() == 'INACTIVO'} ? 'badge-danger' : 
                                                                    (${equipo.estado?.name() == 'MANTENIMIENTO'} ? 'badge-warning' : 'badge-dark'))"
                                                          th:text="${equipo.estado}"></span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>Marca:</th>
                                                <td th:text="${equipo.marcaNombre ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Ubicación:</th>
                                                <td th:text="${equipo.ubicacionNombre ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Serie:</th>
                                                <td th:text="${equipo.serie ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Usuario Asignado:</th>
                                                <td>
                                                    <span th:if="${equipo.usuarioAsignado}" 
                                                          th:text="${equipo.usuarioAsignado.primerNombre + ' ' + equipo.usuarioAsignado.primerApellido}"></span>
                                                    <span th:unless="${equipo.usuarioAsignado}" class="text-muted">Sin asignar</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>Color:</th>
                                                <td th:text="${equipo.color ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Valor:</th>
                                                <td th:text="${equipo.valor ? '$' + #numbers.formatDecimal(equipo.valor, 0, 'COMMA', 2, 'POINT') : '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Tipo Alimentación:</th>
                                                <td th:text="${equipo.tipoAlimentacion ?: '-'}"></td>
                                            </tr>
                                            <tr th:if="${equipo.extras}">
                                                <th>Extras:</th>
                                                <td th:text="${equipo.extras}"></td>
                                            </tr>
                                            <tr>
                                                <th>Fecha de Registro:</th>
                                                <td th:text="${#temporals.format(equipo.fechaCommit, 'dd/MM/yyyy HH:mm')}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Información específica del tipo -->
                        <div th:if="${equipo.tipoEquipo?.name() == 'VEHICULO'}" class="card card-info card-outline">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-car"></i> Información del Vehículo
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Placa:</th>
                                                <td th:text="${vehiculo?.placa ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Modelo:</th>
                                                <td th:text="${vehiculo?.modelo ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Año:</th>
                                                <td th:text="${vehiculo?.anio ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Color:</th>
                                                <td th:text="${vehiculo?.color ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Kilometraje:</th>
                                                <td th:text="${vehiculo?.kilometraje ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div th:if="${equipo.tipoEquipo?.name() == 'ELECTRONICO'}" class="card card-info card-outline">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-laptop"></i> Información del Electrónico
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Modelo:</th>
                                                <td th:text="${electronico?.modelo ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Número de Serie:</th>
                                                <td th:text="${electronico?.numeroSerie ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Sistema Operativo:</th>
                                                <td th:text="${electronico?.sistemaOperativo ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Procesador:</th>
                                                <td th:text="${electronico?.procesador ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>RAM:</th>
                                                <td th:text="${electronico?.memoria ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Almacenamiento:</th>
                                                <td th:text="${electronico?.almacenamiento ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Conectividad:</th>
                                                <td th:text="${electronico?.conectividad ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Operador:</th>
                                                <td th:text="${electronico?.operador ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Alimentación:</th>
                                                <td th:text="${electronico?.alimentacion ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div th:if="${equipo.tipoEquipo?.name() == 'MOBILIARIO'}" class="card card-info card-outline">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-couch"></i> Información del Mobiliario
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Material:</th>
                                                <td th:text="${mobiliario?.material ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Dimensiones:</th>
                                                <td th:text="${mobiliario?.dimensiones ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Color:</th>
                                                <td th:text="${mobiliario?.color ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Peso:</th>
                                                <td th:text="${mobiliario?.peso ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div th:if="${equipo.tipoEquipo?.name() == 'HERRAMIENTA'}" class="card card-info card-outline">
                            <div class="card-header">
                                <h3 class="card-title">
                                    <i class="fas fa-tools"></i> Información de la Herramienta
                                </h3>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Tipo:</th>
                                                <td th:text="${herramienta?.tipo ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Tamaño:</th>
                                                <td th:text="${herramienta?.tamano ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Material:</th>
                                                <td th:text="${herramienta?.material ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                    <div class="col-md-6">
                                        <table class="table table-sm">
                                            <tr>
                                                <th width="40%">Voltaje:</th>
                                                <td th:text="${herramienta?.voltaje ?: '-'}"></td>
                                            </tr>
                                            <tr>
                                                <th>Amperaje:</th>
                                                <td th:text="${herramienta?.amperaje ?: '-'}"></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sidebar con acciones -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Acciones</h3>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2">
                                    <a th:href="@{/equipos/{id}/editar(id=${equipo.id})}" 
                                       class="btn btn-warning btn-block">
                                        <i class="fas fa-edit"></i> Editar Equipo
                                    </a>
                                    
                                    <button type="button" class="btn btn-success btn-block" 
                                            th:onclick="'viewHistory(' + ${equipo.id} + ', \'' + ${equipo.nombre} + '\')'">
                                        <i class="fas fa-history"></i> Ver Historial
                                    </button>
                                    
                                    <div th:unless="${equipo.usuarioAsignado}">
                                        <button type="button" class="btn btn-primary btn-block" 
                                                th:onclick="'abrirModalAsignacion(' + ${equipo.id} + ', \'' + ${equipo.nombre} + '\')'">
                                            <i class="fas fa-user-plus"></i> Asignar Equipo
                                        </button>
                                    </div>
                                    <div th:if="${equipo.usuarioAsignado}">
                                        <button type="button" class="btn btn-secondary btn-block" 
                                                th:onclick="'abrirModalLiberacion(' + ${equipo.id} + ', \'' + ${equipo.nombre} + '\')'">
                                            <i class="fas fa-user-minus"></i> Liberar Equipo
                                        </button>
                                    </div>
                                    
                                    <button type="button" class="btn btn-danger btn-block" 
                                            th:data-equipo-id="${equipo.id}"
                                            th:data-nombre="${equipo.nombre}"
                                            onclick="confirmDeleteFromView(this)">
                                        <i class="fas fa-trash"></i> Eliminar Equipo
                                    </button>
                                    
                                    <a href="/equipos" class="btn btn-secondary btn-block">
                                        <i class="fas fa-arrow-left"></i> Volver a Lista
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Información adicional -->
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">Información del Sistema</h3>
                            </div>
                            <div class="card-body">
                                <small class="text-muted">
                                    <strong>ID del Equipo:</strong> <span th:text="${equipo.id}"></span><br>
                                    <strong>Creado por:</strong> <span th:text="${equipo.creadoPor?.usuario ?: 'Sistema'}"></span><br>
                                    <strong>Último Cambio:</strong> <span th:text="${#temporals.format(equipo.fechaCommit, 'dd/MM/yyyy HH:mm:ss')}"></span>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Modales -->
    <div layout:fragment="modals">
        <!-- Modal Historial -->
        <div class="modal fade" id="historyModal" tabindex="-1" role="dialog" aria-labelledby="historyModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="historyModalLabel">
                            <i class="fas fa-history"></i> Historial de Asignaciones
                        </h4>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div id="historyContent">
                            <div class="text-center">
                                <i class="fas fa-spinner fa-spin fa-2x"></i>
                                <p>Cargando historial...</p>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal Asignación -->
        <div class="modal fade" id="modalAsignacion" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="modalAsignacionTitulo">Asignar Equipo</h4>
                        <button type="button" class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="formAsignacion">
                            <div class="form-group">
                                <label for="usuarioAsignacion">Usuario *</label>
                                <select class="form-control" id="usuarioAsignacion" required>
                                    <option value="">Seleccionar usuario</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="motivoAsignacion">Motivo</label>
                                <textarea class="form-control" id="motivoAsignacion" rows="3" placeholder="Motivo de la asignación (opcional)"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="procesarAsignacion()">Asignar</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal Liberación -->
        <div class="modal fade" id="modalLiberacion" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title" id="modalLiberacionTitulo">Liberar Equipo</h4>
                        <button type="button" class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="formLiberacion">
                            <div class="form-group">
                                <label for="motivoLiberacion">Motivo de Liberación *</label>
                                <select class="form-control" id="motivoLiberacion" required>
                                    <option value="">Seleccionar motivo</option>
                                    <option value="DEVOLUCION_VOLUNTARIA">Devolución Voluntaria</option>
                                    <option value="CAMBIO_AREA">Cambio de Área</option>
                                    <option value="CAMBIO_PUESTO">Cambio de Puesto</option>
                                    <option value="REASIGNACION_ADMINISTRATIVA">Reasignación Administrativa</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="motivoLiberacionDetalle">Detalle</label>
                                <textarea class="form-control" id="motivoLiberacionDetalle" rows="3" placeholder="Detalle del motivo de liberación (opcional)"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-warning" onclick="procesarLiberacion()">Liberar</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div layout:fragment="script">
        <script th:inline="javascript">
            const equipoId = /*[[${equipo.id}]]*/ 0;
            
            function confirmDelete(equipoId, nombre) {
                if (confirm(`¿Está seguro de eliminar el equipo "${nombre}"?\n\nEsta acción eliminará permanentemente el equipo.`)) {
                    $.ajax({
                        url: `/api/v1/equipos/${equipoId}`,
                        method: 'DELETE',
                        success: function() {
                            alert('Equipo eliminado exitosamente');
                            window.location.href = '/equipos';
                        },
                        error: function() {
                            alert('Error al eliminar el equipo');
                        }
                    });
                }
            }
            
            function confirmDeleteFromView(button) {
                const equipoId = button.getAttribute('data-equipo-id');
                const nombre = button.getAttribute('data-nombre');
                confirmDelete(equipoId, nombre);
            }
            
            // Funciones para modales - copiadas de list.html
            window.viewHistory = function(equipoId, nombreEquipo) {
                $('#historyModalLabel').html(`<i class="fas fa-history"></i> Historial de Asignaciones - ${nombreEquipo}`);
                $('#historyContent').html(`
                    <div class="text-center">
                        <i class="fas fa-spinner fa-spin fa-2x"></i>
                        <p>Cargando historial...</p>
                    </div>
                `);
                
                $('#historyModal').modal('show');
                
                $.ajax({
                    url: `/api/v1/equipos/${equipoId}/historial`,
                    method: 'GET',
                    xhrFields: {
                        withCredentials: true
                    },
                    success: function(data) {
                        renderHistoryTable(data);
                    },
                    error: function(xhr, status, error) {
                        $('#historyContent').html(`
                            <div class="alert alert-danger">
                                <i class="fas fa-exclamation-triangle"></i>
                                Error cargando historial: ${xhr.responseText || error}
                            </div>
                        `);
                    }
                });
            };

            function abrirModalAsignacion(equipoId, equipoNombre) {
                $('#modalAsignacionTitulo').text('Asignar Equipo: ' + equipoNombre);
                $('#modalAsignacion').modal('show');
                cargarUsuarios();
            }
            
            function abrirModalLiberacion(equipoId, equipoNombre) {
                $('#modalLiberacionTitulo').text('Liberar Equipo: ' + equipoNombre);
                $('#modalLiberacion').modal('show');
            }
            
            function cargarUsuarios() {
                $.ajax({
                    url: '/api/v1/usuarios/search',
                    method: 'GET',
                    data: {
                        page: 0,
                        size: 100,
                        sort: 'primerNombre',
                        direction: 'asc'
                    },
                    success: function(response) {
                        let select = $('#usuarioAsignacion');
                        select.empty().append('<option value="">Seleccionar usuario</option>');
                        
                        response.content.forEach(function(usuario) {
                            let nombreCompleto = usuario.primerNombre + ' ' + usuario.primerApellido;
                            if (usuario.esEmpleado && usuario.areaNombre) {
                                nombreCompleto += ' (' + usuario.areaNombre + ')';
                            }
                            select.append('<option value="' + usuario.id + '">' + nombreCompleto + '</option>');
                        });
                    },
                    error: function() {
                        alert('Error al cargar usuarios');
                    }
                });
            }
            
            function procesarAsignacion() {
                let usuarioId = $('#usuarioAsignacion').val();
                let motivo = $('#motivoAsignacion').val();
                
                if (!usuarioId) {
                    alert('Debe seleccionar un usuario');
                    return;
                }
                
                $.ajax({
                    url: '/api/v1/equipos/' + equipoId + '/asignar',
                    method: 'POST',
                    data: {
                        usuarioId: usuarioId,
                        motivo: motivo
                    },
                    success: function() {
                        $('#modalAsignacion').modal('hide');
                        location.reload();
                    },
                    error: function(xhr) {
                        let errorMsg = 'Error al asignar equipo';
                        if (xhr.responseText) {
                            errorMsg += ': ' + xhr.responseText;
                        }
                        alert(errorMsg);
                    }
                });
            }
            
            function procesarLiberacion() {
                let motivoCambio = $('#motivoLiberacion').val();
                let motivo = $('#motivoLiberacionDetalle').val();
                
                if (!motivoCambio) {
                    alert('Debe seleccionar un motivo');
                    return;
                }
                
                $.ajax({
                    url: '/api/v1/equipos/' + equipoId + '/liberar',
                    method: 'POST',
                    data: {
                        motivoCambio: motivoCambio,
                        motivo: motivo
                    },
                    success: function() {
                        $('#modalLiberacion').modal('hide');
                        location.reload();
                    },
                    error: function(xhr) {
                        let errorMsg = 'Error al liberar equipo';
                        if (xhr.responseText) {
                            errorMsg += ': ' + xhr.responseText;
                        }
                        alert(errorMsg);
                    }
                });
            }

            function renderHistoryTable(historial) {
                if (!historial || historial.length === 0) {
                    $('#historyContent').html(`
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            No hay historial de asignaciones registrado para este equipo.
                        </div>
                    `);
                    return;
                }
                
                let tableHTML = `
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Fecha Asignación</th>
                                    <th>Motivo Cambio</th>
                                    <th>Usuario Anterior</th>
                                    <th>Usuario Nuevo</th>
                                    <th>Estado Devolución</th>
                                    <th>Fecha Devolución</th>
                                    <th>Observaciones</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                historial.forEach(item => {
                    tableHTML += `
                        <tr>
                            <td>${formatDateTime(item.fechaAsignacion)}</td>
                            <td><span class="badge ${getMotivoBadge(item.motivoCambio)}">${formatMotivoCambio(item.motivoCambio)}</span></td>
                            <td>${item.usuarioAnteriorNombre || '-'}</td>
                            <td>${item.usuarioNuevoNombre || '<span class="text-warning">Liberado</span>'}</td>
                            <td><span class="badge ${getEstadoDevolucionBadge(item.estadoDevolucion)}">${formatEstadoDevolucion(item.estadoDevolucion)}</span></td>
                            <td>${formatDateTime(item.fechaDevolucion) || '-'}</td>
                            <td>${item.observaciones || '-'}</td>
                        </tr>
                    `;
                });
                
                tableHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                $('#historyContent').html(tableHTML);
            }
            
            function formatDateTime(dateString) {
                if (!dateString) return '-';
                const date = new Date(dateString);
                return date.toLocaleString('es-ES');
            }
            
            function getMotivoBadge(motivoCambio) {
                switch(motivoCambio) {
                    case 'ASIGNACION_INICIAL': return 'badge-primary';
                    case 'DEVOLUCION_VOLUNTARIA': return 'badge-warning';
                    case 'CAMBIO_AREA': return 'badge-info';
                    case 'CAMBIO_PUESTO': return 'badge-secondary';
                    case 'REASIGNACION_ADMINISTRATIVA': return 'badge-success';
                    default: return 'badge-light';
                }
            }
            
            function formatMotivoCambio(motivoCambio) {
                switch(motivoCambio) {
                    case 'ASIGNACION_INICIAL': return 'Asignación Inicial';
                    case 'DEVOLUCION_VOLUNTARIA': return 'Devolución Voluntaria';
                    case 'CAMBIO_AREA': return 'Cambio de Área';
                    case 'CAMBIO_PUESTO': return 'Cambio de Puesto';
                    case 'REASIGNACION_ADMINISTRATIVA': return 'Reasignación Administrativa';
                    default: return motivoCambio;
                }
            }

            function getEstadoDevolucionBadge(estado) {
                switch(estado) {
                    case 'PENDIENTE': return 'badge-warning';
                    case 'CONFIRMADA': return 'badge-success';
                    case 'EXTRAVIADO': return 'badge-danger';
                    default: return 'badge-light';
                }
            }

            function formatEstadoDevolucion(estado) {
                switch(estado) {
                    case 'PENDIENTE': return 'Pendiente';
                    case 'CONFIRMADA': return 'Confirmada';
                    case 'EXTRAVIADO': return 'Extraviado';
                    default: return estado || 'N/A';
                }
            }
        </script>
    </div>
</body>
</html>